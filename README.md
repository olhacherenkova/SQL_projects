# SQL_projects

# country_account_email_metrics_top10
Логіка запиту:
1. account_table (Деталізація облікових записів). CTE вибирає дату сесії, країну, інтервал надсилання, статус верифікації та відписки.Рахує кількість унікальних акаунтів (account_cnt) за цими параметрами.
2. account_metric (Ранжування країн за кількістю облікових записів).CTE Рахує загальну кількість акаунтів по кожній країні (total_country_account_cnt). Присвоює ранг країнам за кількістю акаунтів (від найбільшої до найменшої) за допомогою DENSE_RANK.
3. email_table (Деталізація email-активності).CTE Вибирає країну, інтервал надсилання, статус верифікації та відписки. Обчислює дату надсилання, рахує кількість повідомлень: надісланих (sent_msg),відкритих (open_msg), тих, що призвели до візиту (visit_msg).
4. email_metric (Ранжування країн за кількістю надісланих email).Рахує загальну кількість надісланих повідомлень по країнах (total_country_sent_cnt).
Присвоює ранг країнам за кількістю надісланих email.
5. union_table (Об'єднання детальних даних).Об’єднує account_table та email_table.
6. fin_table (Фінальна агрегація).Рахує загальні суми по кожному типу метрики.
7. фінальний SELECT (Фільтрація та Виведення).Об’єднує fin_table з метриками account_metric та email_metric.Виводить повний набір метрик: акаунти, email, ранги.Фільтрує лише ті країни, які входять у топ-10 за кількістю акаунтів або email.


# session_order_product_view
Цей SQL-запит формує єдину таблицю, яка описує шлях користувача від сесії до продукту.
